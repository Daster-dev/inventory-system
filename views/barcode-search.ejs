<%- include('partials/header') %>
  <script src="https://unpkg.com/html5-qrcode"></script>
  <style>
    #scanner { width: 300px; margin: 20px auto; display: none; }
    .product { border: 1px solid #ccc; padding: 10px; margin: 10px; }
    button { margin: 10px; padding: 10px; font-size: 16px; }
  </style>
  
  <h2>ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯</h2>

  <button onclick="startScanner()">ğŸ“· Ø§Ù…Ø³Ø­ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯</button>

  <div id="scanner"></div>

  <% if (product) { %>
  
      <div class="product-card 
  <% if (product.qty === 0) { %> out <% } 
     else if (product.qty < 5) { %> low <% } 
     else { %> ok <% } %>" data-name="<%= product.name.toLowerCase() %>">
  <% if (product.imgPath) { %>
    <img src="<%= product.imgPath %>" alt="<%= product.name %>" id="imgClick">
  <% } %>
  <h3><%= product.name %></h3>
  <p>Ø§Ù„Ù‚Ø³Ù…: <strong><%= product.category %></strong></p>
  <p>Ø§Ù„ÙƒÙ…ÙŠØ©: <%= product.qty %></p>

  <button class="sell-btn" data-id="<%= product.id %>">ØªÙ… Ø§Ù„Ø¨ÙŠØ¹</button>

  <form action="/products/delete/<%= product.id %>" method="POST" style="margin-top:5px;" onsubmit="return confirm('âš ï¸ Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬ØŸ');">
    <button type="submit" class="del-btn" style="background:#c00; color:#fff;">ğŸ—‘ Ø­Ø°Ù Ø§Ù„Ù…Ù†ØªØ¬</button>
  </form>


</div>
	
  <% } %>

  
  
  
  
  
  
  
  
  <script>
    let scanner;
    function startScanner() {
      document.getElementById("scanner").style.display = "block";
      scanner = new Html5Qrcode("scanner");
      scanner.start(
        { facingMode: "environment" },
        { fps: 10, qrbox: 250 },
        (decodedText) => {
          scanner.stop();
          window.location.href = `/barcode-result?code=${decodedText}`;
        },
        (errorMessage) => {
          console.warn("Ø®Ø·Ø£ Ø¨Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©:", errorMessage);
        }
      );
    }

    function restartScanner() {
      if (scanner) {
        scanner.stop().then(() => {
          document.getElementById("scanner").innerHTML = "";
          startScanner();
        });
      } else {
        startScanner();
      }
    }
  </script>
  
  
  
  
  <%- include('partials/footer') %>
